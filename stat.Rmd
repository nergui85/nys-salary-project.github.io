---
title: "Statistical Tests"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
    theme: cosmo
---


```{r}
library(tidyverse)
library(janitor)
library(viridis)
library(plotly)
library(ggplot2)
knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(theme_minimal() + theme(legend.position = "bottom"))

```

```{r}
payroll_data = 
    read_csv("data/payroll_data.csv")
```


# ANOVA Analysis

For additional analysis, an ANOVA was done to determine whether there is a significant difference in mean base salary for municipal workers between the counties in New York State in 2022.  

Null Hypothesis(Ho) = The mean base salary is constant for all counties

Alternative Hypothesis(H1) = The mean base salary is different for all municipalities

```{r}
ms_model = 
  payroll_data %>%
  mutate(county_name = as.factor(county_name)) %>%
  group_by(county_name) %>%
  summarise(ms_mean = base_salary)

res = lm(ms_mean ~ factor(county_name), data = ms_model)

anova_analysis = 
    anova(res) %>% 
    broom::tidy() %>% 
    knitr::kable(caption = "One Way Anova Test for Mean Salary by County")

anova_analysis
```

# Tukey test for Mean Salary by County

```{r}
res1 = aov(ms_mean ~ factor(county_name), data = ms_model)

tukey_ms = TukeyHSD(res1)

tukey_ms

tukey_table = 
    tukey_ms %>% 
    broom::tidy() %>%
    knitr::kable(caption = "Tukey Test for Mean Salary by County")

tukey_table
```

The null hypothesis for this test is that all the base salary means for each county are equal.  The alternative hypothesis is that not all the base salary means for each county are equal.  The level of significance for this test is 0.05.  The p-value for this test is 0 (Table 1).  Based on the results of this F-test, at a level of significance of 0.05, we reject the null hypothesis as there is enough evidence to support that not all the base salary means for each county are equal.

As an ANOVA does not indicate which base salary means are different and we need to control and preserve the overall family-wise error rate at the pre-specified alpha level of 0.05, we have also conducted a Tukeyâ€™s test.  Based on Table 2, the following county comparisons have significant differences in mean salary for municipal workers in 2022 as the p-values are less than 0.05 and the null value of 0 is not included within the corresponding confidence interval: Bronx and Albany, Nassau and Albany, New York and Albany, Richmond and Albany, Kings and Bronx, New York and Bronx, Queens and Bronx, Richmond and Bronx, Sullivan and Bronx, Ulster and Bronx, Westchester and Bronx, Nassau and Delaware, New York and Delaware, Nassau and Kings, New York and Kings, Richmond and Kings, Ulster and Kings, Westchester and Kings, Queens and Nassau, Richmond and Nassau, Sullivan and Nassau, Ulster and Nassau, Westchester and Nassau, Queens and New York, Richmond and New York, Sullivan and New York, Ulster and New York, Westchester and New York, Ulster and Queens, Westchester and Queens, Ulster and Richmond, and Westchester and Richmond.